<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>H·ªá th·ªëng V·∫≠n h√†nh Th√¥ng minh</title>
  <link rel="icon" type="image/jpeg" href="assets/images/icool-logo.jpg" />
  <link rel="shortcut icon" type="image/jpeg" href="assets/images/icool-logo.jpg" />
  <link rel="apple-touch-icon" href="assets/images/icool-logo.jpg" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js"></script>
  <script src="./telegram-config.js"></script>
  <!-- Fallback: N·∫øu file kh√¥ng t·ªìn t·∫°i, s·∫Ω s·ª≠ d·ª•ng gi√° tr·ªã m·∫∑c ƒë·ªãnh trong app.js -->
  <link rel="stylesheet" href="style.css?v=3" />
  <style>
    .category-tab {
      @apply px-4 py-2 text-sm font-medium text-slate-600 border-b-2 border-transparent transition-all duration-200;
      @apply hover:text-indigo-600 hover:border-indigo-300;
    }
    .category-tab.active {
      @apply text-indigo-600 border-indigo-600 font-semibold;
    }
    .main-tab {
      @apply px-6 py-3 text-base font-medium text-slate-600 border-b-2 border-transparent transition-all duration-200;
      @apply hover:text-indigo-600 hover:border-indigo-300;
    }
    .main-tab.active {
      @apply text-indigo-600 border-indigo-600 font-semibold;
    }
    .main-tab-content {
      display: block !important;
    }
    .main-tab-content.hidden {
      display: none !important;
    }
    .activity-time-btn {
      cursor: pointer;
      padding: 2px;
    }
    .activity-time-btn:hover {
      color: #475569;
    }
    /* Date input - kh√¥ng ·∫©n text, ch·ªâ d√πng span ƒë·ªÉ hi·ªÉn th·ªã format hint */
    /* Date input - ·∫©n text browser, hi·ªÉn th·ªã format dd/mm/yyyy */
    .date-input-wrapper {
      position: relative;
    }
    input[type="date"] {
      color: transparent;
    }
    input[type="date"]:focus {
      color: transparent;
      caret-color: #475569;
    }
    .date-format-overlay {
      pointer-events: none;
      user-select: none;
    }
    /* Multi-select assignee styles */
    .remove-assignee-btn {
      cursor: pointer;
      padding: 2px 4px;
      border-radius: 4px;
      transition: background-color 0.2s;
    }
    .remove-assignee-btn:hover {
      background-color: rgba(99, 102, 241, 0.2);
    }
    .assignee-option:hover {
      background-color: #f0f4ff;
    }
    #assigneeMultiSelect:focus-within {
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }
  </style>
</head>
<script src="app.js?v=3" type="module"></script>

<body class="min-h-screen">
  <div id="skeletonLoader" class="w-full h-full flex flex-col items-center">
    <header class="w-full bg-white border-b border-slate-200">
      <div class="container mx-auto flex justify-between items-center p-4">
        <div class="h-6 bg-slate-200 rounded w-1/4 animate-pulse"></div>
        <div class="h-10 w-10 bg-slate-200 rounded-full animate-pulse"></div>
      </div>
    </header>
    <main class="w-full flex-grow container mx-auto p-4 sm:p-6 mt-4">
      <div class="card p-6">
        <div class="h-8 bg-slate-200 rounded w-1/3 mb-6 animate-pulse"></div>
        <div class="space-y-4">
          <div class="h-4 bg-slate-200 rounded w-full animate-pulse"></div>
          <div class="h-4 bg-slate-200 rounded w-5/6 animate-pulse"></div>
          <div class="h-12 bg-slate-200 rounded w-full mt-6 animate-pulse"></div>
        </div>
      </div>
    </main>
  </div>

  <div id="authSection" class="min-h-screen flex items-center justify-center p-4 hidden">
    <div class="w-full max-w-md card p-8 space-y-6">
      <div class="text-center">
        <h2 class="mt-4 text-3xl font-bold text-slate-900">
          ƒêƒÉng nh·∫≠p h·ªá th·ªëng
        </h2>
      </div>
      <div>
        <label for="authEmail" class="block text-slate-700 text-sm font-medium mb-2">T√™n ƒëƒÉng nh·∫≠p:</label><input type="text"
          id="authEmail" class="input-field" placeholder="T√™n ƒëƒÉng nh·∫≠p" />
      </div>
      <div>
        <label for="authPassword" class="block text-slate-700 text-sm font-medium mb-2">M·∫≠t kh·∫©u:</label><input
          type="password" id="authPassword" class="input-field" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
      </div>
      <div class="text-right">
        <button id="forgotPasswordBtn" class="text-sm font-medium text-indigo-600 hover:text-indigo-500">
          Qu√™n m·∫≠t kh·∫©u?
        </button>
      </div>
      <button id="loginBtn" class="btn-primary w-full text-base py-3">
        ƒêƒÉng nh·∫≠p
      </button>
      <div id="authMessage" class="hidden mt-4 p-3 rounded-lg text-sm text-center"></div>
    </div>
  </div>

  <div id="appContainer" class="hidden">
    <aside id="sidebar"
      class="bg-white w-64 min-h-screen fixed top-0 left-0 z-50 lg:translate-x-0 -translate-x-full transition-transform duration-300 ease-in-out border-r border-slate-200 flex flex-col shadow-sm">
      <div class="p-5 border-b border-slate-200">
        <button id="homeBtn" class="font-bold text-lg text-slate-800 focus:outline-none w-full text-left hover:text-indigo-600 transition-colors">
          H·ªá Th·ªëng V·∫≠n H√†nh
        </button>
      </div>
      <nav id="sidebarNav" class="p-4 space-y-2 flex-grow"></nav>
    </aside>

    <div id="mainContent" class="lg:ml-64 transition-all duration-300 ease-in-out">
      <div id="sidebarOverlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden"></div>
      <header class="bg-white/95 backdrop-blur-md sticky top-0 z-30 border-b border-slate-200 shadow-sm">
        <div class="mx-auto flex justify-between items-center p-4">
          <button id="mobileMenuToggle" class="lg:hidden text-xl text-slate-600">
            <i class="fas fa-bars"></i>
          </button>
          <div class="flex-1"></div>
          <div class="flex items-center space-x-4">
            <!-- Online/Offline Status Indicator -->
            <div id="onlineStatusIndicator" class="flex items-center space-x-2 px-3 py-1.5 rounded-full text-sm font-medium hidden">
              <i id="onlineStatusIcon" class="fas fa-circle text-xs"></i>
              <span id="onlineStatusText">ƒêang t·∫£i...</span>
            </div>
            <!-- Language Selector -->
            <div class="relative">
              <button id="languageToggle" class="text-2xl hover:opacity-80 transition-opacity" title="Thay ƒë·ªïi ng√¥n ng·ªØ">
                <span id="currentLanguageFlag">üáªüá≥</span>
              </button>
              <div id="languageDropdownMenu" class="dropdown-menu !w-48 !right-0 !left-auto">
                <button id="selectVietnameseBtn" class="w-full flex items-center p-3 hover:bg-slate-100 text-left language-option" data-lang="vi">
                  <span class="text-2xl mr-3">üáªüá≥</span>
                  <div>
                    <div class="font-medium text-slate-800">Ti·∫øng Vi·ªát</div>
                    <div class="text-xs text-slate-500">Vietnamese</div>
                  </div>
                </button>
                <button id="selectEnglishBtn" class="w-full flex items-center p-3 hover:bg-slate-100 text-left language-option border-t border-slate-200" data-lang="en">
                  <span class="text-2xl mr-3">üá∫üá∏</span>
                  <div>
                    <div class="font-medium text-slate-800">English</div>
                    <div class="text-xs text-slate-500">Ti·∫øng Anh</div>
                  </div>
                </button>
              </div>
            </div>
            <div class="relative">
              <button id="notificationToggle"
                class="text-xl text-slate-600 hover:text-indigo-600 transition-colors notification-badge-container">
                <i class="fas fa-bell"></i>
                <div id="notificationBadge" class="notification-badge"></div>
              </button>
              <div id="notificationMenu" class="dropdown-menu !w-80 sm:!w-96 max-h-96 overflow-y-auto">
                <div class="p-3 font-semibold border-b border-slate-200 flex justify-between items-center">
                  <span>Th√¥ng B√°o</span>
                  <button id="markAllReadBtn" class="text-xs text-indigo-600 hover:text-indigo-700 font-medium hidden">
                    ƒê√°nh d·∫•u t·∫•t c·∫£ ƒë√£ ƒë·ªçc
                  </button>
                </div>
                <div id="notificationList"></div>
              </div>
            </div>
            <div class="relative">
              <button id="userDropdownToggle" class="flex items-center space-x-2">
                <i class="fas fa-user-circle text-2xl text-slate-600"></i><span id="loggedInUserDisplay"
                  class="font-medium text-slate-700 hidden sm:block"></span><i
                  class="fas fa-chevron-down text-xs text-slate-500"></i>
              </button>
              <div id="userDropdownMenu" class="dropdown-menu">
                <div class="p-2 border-b border-slate-100">
                  <p id="dropdownUserName" class="truncate font-semibold"></p>
                  <p id="dropdownUserRole" class="truncate text-xs text-slate-500"></p>
                </div>
                <a href="#" id="myProfileDropdownBtn"
                  class="flex items-center p-2 hover:bg-slate-100"><i
                    class="fas fa-user fa-fw mr-2"></i>H·ªì S∆° C·ªßa T√¥i</a>
                <a href="#" id="logoutDropdownBtn"
                  class="flex items-center p-2 text-red-600 hover:bg-slate-100 rounded-b-md"><i
                    class="fas fa-sign-out-alt fa-fw mr-2"></i>Tho√°t</a>
              </div>
            </div>
          </div>
        </div>
      </header>
      <main class="p-4 sm:p-6 space-y-6"></main>
    </div>

    <div id="viewsContainer" class="hidden">
      <div id="attendanceView">
        <div class="card p-6 lg:p-8">
          <h2 class="text-3xl font-bold text-slate-800 mb-6 flex items-center">
            <i class="fas fa-user-clock mr-3 text-indigo-600"></i>ƒêi·ªÉm Danh
            Ch·∫•m C√¥ng
          </h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
              <div class="mb-4">
                <label class="block text-slate-600 mb-2">T√™n nh√¢n vi√™n:</label><input type="text" id="employeeName"
                  class="input-field bg-slate-100" disabled />
              </div>
              <div class="flex space-x-4">
                <button id="checkInBtn" class="btn-primary flex-1 py-3">
                  <i class="fas fa-sign-in-alt mr-2"></i>Check In</button><button id="checkOutBtn"
                  class="btn-secondary flex-1 py-3">
                  <i class="fas fa-sign-out-alt mr-2"></i>Check Out
                </button>
              </div>
              <div id="attendanceMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
            </div>
            <div>
              <h3 class="text-lg font-semibold text-slate-800 mb-3">
                L·ªãch S·ª≠ G·∫ßn ƒê√¢y
              </h3>
              <ul id="attendanceHistory" class="space-y-2 text-slate-600 max-h-48 overflow-y-auto pr-2"></ul>
            </div>
          </div>
        </div>
      </div>
      <div id="manageAccountsView">
        <div id="adminSettingsCard" class="card p-6 mb-6 hidden">
          <h3 class="text-xl font-bold text-slate-800 mb-4">
            C√†i ƒë·∫∑t H·ªá th·ªëng (Admin)
          </h3>
          <div class="space-y-4">
            <div>
              <label for="escalationTimeInput" class="font-medium text-sm">Th·ªùi gian g·ª≠i th√¥ng b√°o cho s·ª± c·ªë ch∆∞a ƒë∆∞·ª£c
                x·ª≠ l√Ω
                (ph√∫t):</label>
              <input type="number" id="escalationTimeInput" class="input-field" value="60" />
            </div>
            <div class="flex items-center space-x-2">
              <input type="checkbox" id="escalationToggle" class="form-checkbox h-4 w-4 text-indigo-600 rounded" />
              <label for="escalationToggle" class="font-medium text-sm cursor-pointer">B·∫≠t t√≠nh nƒÉng th√¥ng b√°o t·ª±
                ƒë·ªông</label>
            </div>
            <div>
              <button id="saveSettingsBtn" class="btn-primary w-full sm:w-auto">
                L∆∞u C√†i ƒë·∫∑t
              </button>
            </div>
          </div>
          <div id="settingsMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
        </div>
        <div class="card p-6 mb-6">
          <h3 class="text-xl font-bold text-slate-800 mb-4">
            T·∫°o T√†i Kho·∫£n M·ªõi 
          </h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="font-medium text-sm">Email <span class="text-red-500">*</span>:</label>
              <input type="email" id="createAccountEmail" class="input-field" 
                placeholder="user@example.com ho·∫∑c user@mail.icool.com.vn" autocomplete="off" />
              <p class="text-xs text-slate-500 mt-1">C√≥ th·ªÉ nh·∫≠p email t√πy ch·ªânh ho·∫∑c email @mail.icool.com.vn</p>
            </div>
            <div>
              <label class="font-medium text-sm">M·∫≠t kh·∫©u (t·ªëi thi·ªÉu 6 k√Ω t·ª±) <span class="text-red-500">*</span>:</label><input type="password"
                id="createAccountPassword" class="input-field" autocomplete="new-password" />
            </div>
            <div>
              <label class="font-medium text-sm">T√™n ƒëƒÉng nh·∫≠p (t√πy ch·ªçn - ƒë·ªÉ ƒëƒÉng nh·∫≠p b·∫±ng t√™n thay v√¨ email):</label>
              <input type="text" id="createAccountLoginName" class="input-field" 
                placeholder="V√≠ d·ª•: Hoangnh2787" autocomplete="off" />
              <p class="text-xs text-slate-500 mt-1">N·∫øu ƒë·ªÉ tr·ªëng, s·∫Ω t·ª± ƒë·ªông l·∫•y ph·∫ßn tr∆∞·ªõc @ c·ªßa email</p>
            </div>
            <div>
              <label class="font-medium text-sm">T√™n ng∆∞·ªùi d√πng <span class="text-red-500">*</span>:</label><input type="text" id="createAccountUsername"
                class="input-field" autocomplete="off" />
            </div>
            
            <div>
              <label class="font-medium text-sm">Vai tr√≤:</label>
              <select id="createAccountRole" class="select-field">
                </select>
            </div>
            
            <div id="createAccountEmployeeIdContainer">
              <label class="font-medium text-sm">M√£ nh√¢n vi√™n (MSNV):</label><input type="text"
                id="createAccountEmployeeId" class="input-field" autocomplete="off" />
            </div>
            
            <div id="createAccountBranchContainer" class="md:col-span-2 hidden">
              <label class="font-medium text-sm">Chi nh√°nh <span class="text-red-500">*</span>:</label>
              <select id="createAccountBranch" class="select-field">
                <option value="">-- Ch·ªçn chi nh√°nh --</option>
              </select>
            </div>
            
          </div>
          <button id="createAccountBtn" class="btn-primary mt-4">
            T·∫°o T√†i Kho·∫£n
          </button>
          <div id="createAccountMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
        </div>
        <div class="card p-6 mb-6">
          <h3 class="text-xl font-bold text-slate-800 mb-4">
            T·∫°o H√†ng Lo·∫°t T·ª´ Excel
          </h3>
          <p class="text-sm text-slate-600 mb-3">
            T·∫£i l√™n file Excel (.xlsx, .xls) v·ªõi c√°c c·ªôt: <strong>`email`</strong>, <strong>`password`</strong>,
            <strong>`displayName`</strong>, <strong>`employeeId`</strong>, <strong>`role`</strong>. 
            <br><strong>C√°c c·ªôt t√πy ch·ªçn:</strong> <strong>`loginName`</strong> (t√™n ƒëƒÉng nh·∫≠p), <strong>`branch`</strong> (chi nh√°nh - b·∫Øt bu·ªôc cho 'Nh√¢n vi√™n' v√† 'Chi nh√°nh').
            <br><strong>L∆∞u √Ω quan tr·ªçng:</strong>
            <br>‚Ä¢ N·∫øu `email` ƒë√£ t·ªìn t·∫°i: Ch·ªâ c·∫≠p nh·∫≠t `displayName`, `employeeId`, `loginName` v√† `branch` (n·∫øu c√≥). <strong>M·∫≠t kh·∫©u v√† quy·ªÅn (role) s·∫Ω KH√îNG b·ªã thay ƒë·ªïi</strong> ƒë·ªÉ b·∫£o v·ªá t√†i kho·∫£n hi·ªán c√≥.
            <br>‚Ä¢ N·∫øu ch∆∞a c√≥: T√†i kho·∫£n m·ªõi s·∫Ω ƒë∆∞·ª£c t·∫°o (m·∫≠t kh·∫©u l√† b·∫Øt bu·ªôc cho t√†i kho·∫£n m·ªõi). Vai tr√≤ h·ª£p l·ªá l√† 'Admin', 'Manager', 'Nh√¢n vi√™n', 'Chi nh√°nh'.
            <br>‚Ä¢ File m·∫´u ƒë√£ bao g·ªìm h∆∞·ªõng d·∫´n chi ti·∫øt trong sheet "HuongDan".
          </p>
          <input type="file" id="excelFileInput" class="input-field mb-3" accept=".xlsx, .xls" />
          <div class="flex space-x-2">
            <button id="importExcelBtn" class="btn-primary">
              Nh·∫≠p D·ªØ Li·ªáu
            </button>
            <button id="downloadTemplateBtn" class="btn-secondary">
              T·∫£i file m·∫´u
            </button>
          </div>
          <div id="importExcelMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
        </div>
        <div class="card p-6">
          <div class="flex flex-wrap justify-between items-center mb-4 gap-4">
            <div>
              <h3 class="text-xl font-bold text-slate-800">
                Danh S√°ch T√†i Kho·∫£n
              </h3>
              <div id="accountsCountDisplay" class="text-sm text-slate-600 mt-1">
                <i class="fas fa-users mr-1.5 text-indigo-500"></i>
                <span id="accountsCountText">ƒêang t·∫£i...</span>
              </div>
            </div>
            <div class="flex items-center space-x-4">
              <button id="exportAllAccountsBtn" class="btn-primary">
                <i class="fas fa-file-excel mr-2"></i>Xu·∫•t Excel Danh S√°ch T√†i Kho·∫£n
              </button>
              <button id="exportAccountsForEditBtn" class="btn-secondary">
                <i class="fas fa-download mr-2"></i>T·∫£i Danh S√°ch ƒê·ªÉ Ch·ªânh S·ª≠a
              </button>
              <button id="exportAllAttendanceBtn" class="btn-secondary hidden">
                <i class="fas fa-file-excel mr-2"></i>Xu·∫•t File Ch·∫•m C√¥ng (To√†n b·ªô)
              </button>
              <label class="flex items-center space-x-2 cursor-pointer">
                <input type="checkbox" id="showDisabledAccountsToggle"
                  class="form-checkbox h-4 w-4 text-indigo-600 rounded" />
                <span class="text-sm text-slate-600">Hi·ªÉn th·ªã t√†i kho·∫£n ƒë√£ v√¥ hi·ªáu h√≥a</span>
              </label>
            </div>
          </div>
          <div class="mb-4">
            <div class="relative max-w-md">
              <input type="text" id="accountSearchInput" 
                class="input-field pr-10" 
                placeholder="T√¨m ki·∫øm theo t√™n, email, MSNV, vai tr√≤ ho·∫∑c chi nh√°nh..."
                autocomplete="off" />
              <i class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 pointer-events-none"></i>
            </div>
            <p class="text-xs text-slate-500 mt-1.5 flex items-center">
              <i class="fas fa-info-circle mr-1.5 text-indigo-500"></i>
              <span>G√µ ƒë·ªÉ t√¨m ki·∫øm nhanh t√†i kho·∫£n trong danh s√°ch</span>
            </p>
          </div>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-slate-200 responsive-table">
              <thead class="bg-slate-50">
                <tr>
                  <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                    MSNV
                  </th>
                  <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                    T√™n Ng∆∞·ªùi D√πng
                  </th>
                  <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                    Email
                  </th>
                  <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                    Vai Tr√≤
                  </th>
                  <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                    Chi Nh√°nh
                  </th>
                  <th class="px-4 py-3 text-right text-xs font-semibold text-slate-500 uppercase">
                    H√†nh ƒê·ªông
                  </th>
                </tr>
              </thead>
              <tbody id="accountsTableBody" class="bg-white divide-y divide-slate-200"></tbody>
            </table>
          </div>
          <div id="accountsPagination" class="flex justify-between items-center mt-4"></div>
        </div>
      </div>
      <div id="dashboardView">
        <h2 class="text-3xl font-bold text-slate-800 mb-4">Dashboard</h2>

        <div class="border-b border-slate-200">
          <nav id="dashboardTabs" class="-mb-px flex space-x-6 overflow-x-auto pb-2" aria-label="Tabs"></nav>
        </div>

        <div id="dashboardTabContent" class="mt-6"></div>
      </div>
      <div id="issueReportView">
        <div class="card p-6 lg:p-8">
          <h2 class="text-2xl sm:text-3xl font-bold text-slate-800 mb-6 flex items-center">
            <i class="fas fa-exclamation-triangle mr-3 text-red-600"></i>B√°o
            L·ªói & S·ª± C·ªë
          </h2>

          <form id="issueReportForm" class="space-y-6">
            <!-- Nh√≥m 1: Th√¥ng tin c∆° b·∫£n -->
            <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
              <h3 class="text-lg font-semibold text-slate-700 mb-4 flex items-center">
                <i class="fas fa-info-circle mr-2 text-indigo-600"></i>Th√¥ng tin c∆° b·∫£n
              </h3>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="reporterName" class="block text-slate-600 text-sm font-medium mb-2">
                    Ng∆∞·ªùi b√°o c√°o <span class="text-red-500">*</span>
                  </label>
                  <input type="text" id="reporterName" class="input-field bg-slate-100" disabled />
                </div>

                <div>
                  <label for="issueType" class="block text-slate-600 text-sm font-medium mb-2">
                    Lo·∫°i s·ª± c·ªë <span class="text-red-500">*</span>
                  </label>
                  <select id="issueType" class="select-field">
                    <option value="">-- Ch·ªçn lo·∫°i s·ª± c·ªë --</option>
                    <option value="K·ªπ thu·∫≠t">K·ªπ thu·∫≠t</option>
                    <option value="V·∫≠n h√†nh">V·∫≠n h√†nh</option>
                    <option value="H·ªá th·ªëng">H·ªá th·ªëng</option>
                    <option value="Con ng∆∞·ªùi">Con ng∆∞·ªùi</option>
                    <option value="Kh√°c">Kh√°c</option>
                  </select>
                </div>

                <div>
                  <label for="issuePriority" class="block text-slate-600 text-sm font-medium mb-2">
                    M·ª©c ƒë·ªô ∆∞u ti√™n <span class="text-red-500">*</span>
                  </label>
                  <select id="issuePriority" class="select-field">
                    <option value="Trung b√¨nh" selected>Trung b√¨nh</option>
                    <option value="Th·∫•p">Th·∫•p</option>
                    <option value="Nghi√™m tr·ªçng">Nghi√™m tr·ªçng</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Nh√≥m 2: V·ªã tr√≠ s·ª± c·ªë -->
            <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
              <h3 class="text-lg font-semibold text-slate-700 mb-4 flex items-center">
                <i class="fas fa-map-marker-alt mr-2 text-indigo-600"></i>V·ªã tr√≠ s·ª± c·ªë
              </h3>
              
              <!-- T√¨m ki·∫øm v·ªã tr√≠ nhanh -->
              <div class="mb-4">
                <label for="locationSearch" class="block text-slate-600 text-sm font-medium mb-2">
                  <i class="fas fa-search mr-1 text-indigo-600"></i>T√¨m ki·∫øm nhanh (Khuy·∫øn ngh·ªã)
                </label>
                <div class="relative">
                  <input type="text" id="locationSearch" class="input-field pr-10" 
                    placeholder="G√µ t√™n ph√≤ng (v√≠ d·ª•: P.201, P.102) ho·∫∑c t√™n chi nh√°nh..."
                    autocomplete="off" />
                  <i class="fas fa-magic absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-400 pointer-events-none"></i>
                  <div id="locationSearchResults" class="hidden mt-2 bg-white border border-slate-200 rounded-lg shadow-lg max-h-60 overflow-y-auto absolute w-full top-full left-0 z-50"></div>
                </div>
                <p class="text-xs text-slate-500 mt-1.5 flex items-center">
                  <i class="fas fa-lightbulb mr-1.5 text-yellow-500"></i>
                  <span>G√µ t√™n ph√≤ng ƒë·ªÉ t·ª± ƒë·ªông ƒëi·ªÅn Chi nh√°nh v√† T·∫ßng</span>
                </p>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label for="issueBranch" class="block text-slate-600 text-sm font-medium mb-2">
                    Chi nh√°nh <span class="text-red-500">*</span>
                  </label>
                  <select id="issueBranch" class="select-field">
                    <option value="">-- Ch·ªçn chi nh√°nh --</option>
                  </select>
                </div>

                <div id="issueScopeContainer">
                  <label class="block text-slate-600 text-sm font-medium mb-2">
                    Ph·∫°m vi s·ª± c·ªë <span class="text-red-500">*</span>
                  </label>
                  <div class="flex items-center space-x-6 mt-1 bg-white p-3 rounded-md border border-slate-200">
                    <label class="flex items-center space-x-2 cursor-pointer">
                      <input type="radio" name="issueScope" value="all_rooms" class="form-radio h-4 w-4 text-indigo-600"
                        checked />
                      <span class="text-sm font-medium">T·∫•t c·∫£ ph√≤ng</span>
                    </label>
                    <label class="flex items-center space-x-2 cursor-pointer">
                      <input type="radio" name="issueScope" value="specific_rooms"
                        class="form-radio h-4 w-4 text-indigo-600" />
                      <span class="text-sm font-medium">Ph√≤ng c·ª• th·ªÉ</span>
                    </label>
                  </div>
                </div>

                <div id="floorSelectorContainer" class="hidden">
                  <label for="issueFloor" class="block text-slate-600 text-sm font-medium mb-2">
                    T·∫ßng <span class="text-red-500">*</span>
                  </label>
                  <select id="issueFloor" class="select-field">
                    <option value="">-- Ch·ªçn t·∫ßng --</option>
                  </select>
                </div>

                <div id="specificRoomsContainer" class="hidden">
                  <label for="specificRoomsTrigger" class="block text-slate-600 text-sm font-medium mb-2">
                    Ch·ªçn ph√≤ng c·ª• th·ªÉ <span class="text-red-500">*</span>
                  </label>
                  <div class="custom-select-container">
                    <div id="specificRoomsTrigger" class="custom-select-trigger" tabindex="0">
                    </div>
                    <div id="specificRoomsOptions" class="custom-select-options">
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Nh√≥m 3: M√¥ t·∫£ v√† h√¨nh ·∫£nh -->
            <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
              <h3 class="text-lg font-semibold text-slate-700 mb-4 flex items-center">
                <i class="fas fa-file-alt mr-2 text-indigo-600"></i>M√¥ t·∫£ v√† h√¨nh ·∫£nh
              </h3>
              <div class="space-y-4">
                <div>
                  <label for="issueDescription" class="block text-slate-600 text-sm font-medium mb-2">
                    M√¥ t·∫£ chi ti·∫øt <span class="text-red-500">*</span>
                  </label>
                  <textarea id="issueDescription" class="textarea-field h-32"
                    placeholder="M√¥ t·∫£ chi ti·∫øt v·ªÅ s·ª± c·ªë, nguy√™n nh√¢n (n·∫øu bi·∫øt), v√† c√°c th√¥ng tin li√™n quan..."></textarea>
                  <p class="text-xs text-slate-500 mt-1.5">
                    <i class="fas fa-info-circle mr-1"></i>Vui l√≤ng m√¥ t·∫£ r√µ r√†ng ƒë·ªÉ h·ªó tr·ª£ x·ª≠ l√Ω nhanh ch√≥ng
                  </p>
                </div>

                <div>
                  <label for="issueImage" class="block text-slate-600 text-sm font-medium mb-2">
                    <i class="fas fa-image mr-1"></i>·∫¢nh m√¥ t·∫£ l·ªói <span class="text-red-500">*</span>
                  </label>
                  <div class="flex items-center space-x-3">
                    <input type="file" id="issueImage" accept="image/*" class="input-field flex-1" required />
                    <span class="text-xs text-slate-500 whitespace-nowrap">
                      <i class="fas fa-compress mr-1"></i>·∫¢nh s·∫Ω ƒë∆∞·ª£c n√©n t·ª± ƒë·ªông
                    </span>
                  </div>
                  <p class="text-xs text-slate-500 mt-1.5">
                    <i class="fas fa-lightbulb mr-1"></i>Vui l√≤ng t·∫£i l√™n ·∫£nh ƒë·ªÉ m√¥ t·∫£ s·ª± c·ªë r√µ r√†ng h∆°n (b·∫Øt bu·ªôc)
                  </p>
                </div>
              </div>
            </div>

            <!-- N√∫t g·ª≠i -->
            <div class="flex items-center justify-between pt-4 border-t border-slate-200">
              <p class="text-xs text-slate-500">
                <span class="text-red-500">*</span> Tr∆∞·ªùng b·∫Øt bu·ªôc
              </p>
              <button type="button" id="reportIssueBtn" class="btn-primary px-8 py-3 text-base">
                <i class="fas fa-paper-plane mr-2"></i>G·ª≠i B√°o C√°o
              </button>
            </div>

            <!-- Th√¥ng b√°o -->
            <div id="issueMessage" class="hidden p-3 rounded-lg text-sm"></div>
          </form>
        </div>
      </div>
      <div id="issueHistoryView">
        <div class="card p-6 lg:p-8">
          <h2 class="text-2xl lg:text-3xl font-bold text-slate-800 mb-2 flex items-center">
            <i class="fas fa-history mr-3 text-indigo-600"></i>L·ªãch S·ª≠ B√°o C√°o
          </h2>
          <p class="text-slate-500 text-sm mb-6">Theo d√µi v√† qu·∫£n l√Ω t·∫•t c·∫£ b√°o c√°o s·ª± c·ªë</p>
          
          <!-- Mode Toggle: Current Reports vs Archive -->
          <div class="mb-6 flex flex-wrap items-center gap-4 bg-gradient-to-br from-slate-50 to-indigo-50/30 p-5 rounded-xl border border-slate-200/80">
            <span class="text-sm font-medium text-slate-600">Ch·∫ø ƒë·ªô xem:</span>
            <div class="flex gap-3">
              <button 
                id="issueHistoryModeCurrent" 
                class="issue-history-mode-btn active"
                data-mode="current"
              >
                <i class="fas fa-clock mr-2"></i>B√°o C√°o Hi·ªán T·∫°i
              </button>
              <button 
                id="issueHistoryModeArchive" 
                class="issue-history-mode-btn"
                data-mode="archive"
              >
                <i class="fas fa-archive mr-2"></i>B√°o C√°o Archive
              </button>
            </div>
            <p class="text-xs text-slate-500 ml-auto hidden sm:block">
              <i class="fas fa-info-circle mr-1"></i>
              <span id="issueHistoryModeDescription">Xem t·∫•t c·∫£ b√°o c√°o hi·ªán t·∫°i</span>
            </p>
          </div>
          
          <!-- Month/Year Selector Section (only for archive mode) -->
          <div id="issueHistoryArchiveSelector" class="card p-5 mb-6 bg-slate-50 border border-slate-200 hidden">
            <h3 class="text-lg font-semibold text-slate-700 mb-4 flex items-center">
              <i class="fas fa-calendar-alt mr-2 text-indigo-600"></i>Ch·ªçn th√°ng/nƒÉm ƒë·ªÉ xem b√°o c√°o t·ª´ archive
            </h3>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 items-end">
              <div>
                <label for="issueHistoryMonth" class="block text-slate-600 text-sm font-medium mb-2">
                  Th√°ng/NƒÉm <span class="text-red-500">*</span>
                </label>
                <input 
                  type="month" 
                  id="issueHistoryMonth" 
                  class="input-field"
                  required
                />
                <p class="text-xs text-slate-500 mt-1.5">
                  <i class="fas fa-info-circle mr-1"></i>
                  Ch·ªçn th√°ng/nƒÉm ƒë·ªÉ xem b√°o c√°o t·ª´ archive
                </p>
              </div>
              <div class="flex items-end gap-2">
                <button 
                  id="loadIssueHistoryBtn" 
                  type="button"
                  class="btn-primary w-full"
                >
                  <i class="fas fa-search mr-2"></i>Xem B√°o C√°o
                </button>
                <button id="clearIssueHistoryBtn" class="btn-secondary hidden">
                  <i class="fas fa-times mr-2"></i>X√≥a
                </button>
              </div>
            </div>
            <div id="issueHistorySelectorMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
          </div>
          
          <!-- Results Section -->
          <div id="issueHistoryResults">
            <div class="flex flex-wrap justify-between items-center mb-6 gap-4">
              <div>
                <h3 id="issueHistoryResultsTitle" class="text-lg font-semibold text-slate-800"></h3>
                <p id="issueHistoryResultsSubtitle" class="text-sm text-slate-500 mt-0.5"></p>
              </div>
              <div class="flex items-center gap-3">
                <button id="toggleFiltersBtn" class="btn-secondary text-sm">
                  <i class="fas fa-filter mr-2"></i>B·ªô L·ªçc
                </button>
                <button id="exportIssueHistoryBtn" class="btn-primary text-sm">
                  <i class="fas fa-file-excel mr-2"></i>Xu·∫•t Excel
                </button>
              </div>
            </div>
            
            <!-- Filter Section -->
          <div id="filterSection" class="mb-6 p-5 bg-slate-50/80 rounded-xl border border-slate-200 hidden">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-base font-semibold text-slate-700 flex items-center">
                <i class="fas fa-sliders-h mr-2 text-indigo-600"></i>L·ªçc d·ªØ li·ªáu
              </h3>
              <span id="activeFiltersCount" class="text-xs font-medium text-indigo-600 bg-indigo-50 px-2 py-1 rounded-full hidden"></span>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
              <div>
                <label for="filterBranch" class="block text-slate-600 text-sm font-medium mb-1.5">Chi nh√°nh</label>
                <select id="filterBranch" class="select-field">
                  <option value="">T·∫•t c·∫£</option>
                </select>
              </div>
              <div>
                <label for="filterIssueType" class="block text-slate-600 text-sm font-medium mb-1.5">Lo·∫°i s·ª± c·ªë</label>
                <select id="filterIssueType" class="select-field">
                  <option value="">T·∫•t c·∫£</option>
                  <option value="K·ªπ thu·∫≠t">K·ªπ thu·∫≠t</option>
                  <option value="V·∫≠n h√†nh">V·∫≠n h√†nh</option>
                  <option value="H·ªá th·ªëng">H·ªá th·ªëng</option>
                  <option value="Con ng∆∞·ªùi">Con ng∆∞·ªùi</option>
                  <option value="Kh√°c">Kh√°c</option>
                </select>
              </div>
              <div>
                <label for="filterStatus" class="block text-slate-600 text-sm font-medium mb-1.5">Tr·∫°ng th√°i</label>
                <select id="filterStatus" class="select-field">
                  <option value="">T·∫•t c·∫£</option>
                  <option value="Ch·ªù x·ª≠ l√Ω">Ch·ªù x·ª≠ l√Ω</option>
                  <option value="ƒêang x·ª≠ l√Ω">ƒêang x·ª≠ l√Ω</option>
                  <option value="ƒê√£ gi·∫£i quy·∫øt">ƒê√£ gi·∫£i quy·∫øt</option>
                </select>
              </div>
              <div>
                <label for="filterReporter" class="block text-slate-600 text-sm font-medium mb-1.5">Ng∆∞·ªùi g·ª≠i</label>
                <select id="filterReporter" class="select-field">
                  <option value="">T·∫•t c·∫£</option>
                </select>
              </div>
              <div class="sm:col-span-2 lg:col-span-2">
                <label class="block text-slate-600 text-sm font-medium mb-1.5">Ph·∫°m vi ng√†y b√°o c√°o</label>
                <div class="flex flex-wrap items-center gap-2">
                  <div class="flex items-center gap-1.5 flex-1 min-w-[140px]">
                    <input type="date" id="filterDateFrom" class="input-field flex-1 min-w-0" placeholder="T·ª´ ng√†y" />
                    <span class="text-slate-400 text-sm shrink-0">‚Üí</span>
                    <input type="date" id="filterDateTo" class="input-field flex-1 min-w-0" placeholder="ƒê·∫øn ng√†y" />
                  </div>
                  <div class="flex flex-wrap gap-1.5 shrink-0">
                    <button type="button" id="filterDate7Days" class="px-2.5 py-1.5 text-xs font-medium rounded-lg bg-slate-100 text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors">7 ng√†y qua</button>
                    <button type="button" id="filterDateThisMonth" class="px-2.5 py-1.5 text-xs font-medium rounded-lg bg-slate-100 text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors">Th√°ng n√†y</button>
                    <button type="button" id="filterDateLastMonth" class="px-2.5 py-1.5 text-xs font-medium rounded-lg bg-slate-100 text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors">Th√°ng tr∆∞·ªõc</button>
                  </div>
                </div>
                <p class="text-xs text-slate-500 mt-1">Ch·ªçn kho·∫£ng th·ªùi gian b√°o c√°o ƒë∆∞·ª£c t·∫°o</p>
              </div>
            </div>
            <div class="flex flex-wrap justify-end items-center gap-2 mt-4 pt-4 border-t border-slate-200">
              <button id="clearFiltersBtn" class="btn-secondary text-sm">
                <i class="fas fa-redo mr-1.5"></i>X√≥a b·ªô l·ªçc
              </button>
              <button id="applyFiltersBtn" class="btn-primary text-sm">
                <i class="fas fa-search mr-1.5"></i>√Åp d·ª•ng
              </button>
            </div>
            </div>
            
            <div class="overflow-x-auto rounded-xl border border-slate-200 overflow-hidden">
              <table class="min-w-full divide-y divide-slate-200 responsive-table">
                <thead class="bg-slate-100/80">
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Chi nh√°nh
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      V·ªã tr√≠ c·ª• th·ªÉ
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Ng∆∞·ªùi g·ª≠i
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Lo·∫°i s·ª± c·ªë
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Ng√†y b√°o c√°o
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase whitespace-nowrap">
                      Ng√†y gi·∫£i quy·∫øt
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Tr·∫°ng th√°i
                    </th>
                    <th class="px-4 py-3 text-right text-xs font-semibold text-slate-500 uppercase">
                      H√†nh ƒê·ªông
                    </th>
                  </tr>
                </thead>
                <tbody id="issueHistoryTableBody" class="bg-white divide-y divide-slate-200">
                  <tr>
                    <td colspan="8" class="text-center p-8 text-slate-500">
                      <i class="fas fa-calendar-check text-4xl mb-4 text-slate-300"></i>
                      <p class="text-base font-medium">Ch∆∞a ch·ªçn th√°ng/nƒÉm ƒë·ªÉ xem b√°o c√°o</p>
                      <p class="text-sm mt-2">Vui l√≤ng ch·ªçn th√°ng/nƒÉm ·ªü tr√™n v√† nh·∫•n "Xem B√°o C√°o"</p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="issueHistoryPagination" class="flex justify-between items-center mt-4"></div>
          </div>
        </div>
      </div>
      <div id="myTasksView">
        <div class="card p-6">
          <h2 class="text-2xl font-bold text-slate-800 mb-4">
            Nhi·ªám V·ª• C·ªßa T√¥i
          </h2>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-slate-200 responsive-table">
              <thead class="bg-slate-50">
                <tr>
                  <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                    Chi nh√°nh
                  </th>
                  <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                    Lo·∫°i s·ª± c·ªë
                  </th>
                  <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                    Ng√†y b√°o c√°o
                  </th>
                  <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                    Tr·∫°ng th√°i
                  </th>
                  <th class="px-4 py-3 text-right text-xs font-semibold text-slate-500 uppercase">
                    H√†nh ƒê·ªông
                  </th>
                </tr>
              </thead>
              <tbody id="myTasksTableBody" class="bg-white divide-y divide-slate-200"></tbody>
            </table>
          </div>
          <div id="myTasksPagination" class="flex justify-between items-center mt-4"></div>
        </div>
      </div>
      
      <!-- Qu·∫£n L√Ω Ca L√†m Vi·ªác (Admin only) -->
      <div id="manageShiftsView">
        <div class="card p-4 sm:p-6">
          <h2 class="text-xl sm:text-2xl font-bold text-slate-800 mb-4 sm:mb-6 flex items-center">
            <i class="fas fa-calendar-alt mr-2 sm:mr-3 text-indigo-600"></i>Qu·∫£n L√Ω Ca L√†m Vi·ªác
          </h2>
          
          <!-- T·∫°o ca m·ªõi -->
          <div class="card p-4 sm:p-5 mb-6 bg-slate-50 border border-slate-200">
            <h3 class="text-base sm:text-lg font-semibold text-slate-700 mb-4">
              <i class="fas fa-plus-circle mr-2 text-indigo-600"></i>T·∫°o Ca L√†m Vi·ªác M·ªõi
            </h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4">
              <div>
                <label for="shiftName" class="block text-slate-600 text-sm font-medium mb-2">
                  T√™n ca <span class="text-red-500">*</span>
                </label>
                <input type="text" id="shiftName" class="input-field" placeholder="VD: Ca S√°ng, Ca Chi·ªÅu" />
              </div>
              <div>
                <label for="shiftStartTime" class="block text-slate-600 text-sm font-medium mb-2">
                  Gi·ªù b·∫Øt ƒë·∫ßu <span class="text-red-500">*</span>
                </label>
                <input type="time" id="shiftStartTime" class="input-field" />
              </div>
              <div>
                <label for="shiftEndTime" class="block text-slate-600 text-sm font-medium mb-2">
                  Gi·ªù k·∫øt th√∫c <span class="text-red-500">*</span>
                </label>
                <input type="time" id="shiftEndTime" class="input-field" />
              </div>
              <div>
                <label for="shiftBreakDuration" class="block text-slate-600 text-sm font-medium mb-2">
                  Th·ªùi gian ngh·ªâ (ph√∫t)
                </label>
                <input type="number" id="shiftBreakDuration" class="input-field" value="0" min="0" />
              </div>
            </div>
            <button id="createShiftBtn" class="btn-primary mt-4 w-full sm:w-auto">
              <i class="fas fa-plus mr-2"></i>T·∫°o Ca
            </button>
            <div id="shiftMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
          </div>

          <!-- Danh s√°ch ca -->
          <div class="mb-6">
            <h3 class="text-base sm:text-lg font-semibold text-slate-700 mb-4">
              <i class="fas fa-list mr-2 text-indigo-600"></i>Danh S√°ch Ca L√†m Vi·ªác
            </h3>
            <div class="overflow-x-auto -mx-4 sm:mx-0">
              <div class="inline-block min-w-full align-middle">
                <table class="min-w-full divide-y divide-slate-200 responsive-table">
                <thead class="bg-slate-50">
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">T√™n ca</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">Gi·ªù b·∫Øt ƒë·∫ßu</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">Gi·ªù k·∫øt th√∫c</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">Th·ªùi gian ngh·ªâ</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">T·ªïng gi·ªù</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">S·ªë nh√¢n vi√™n</th>
                    <th class="px-4 py-3 text-right text-xs font-semibold text-slate-500 uppercase">H√†nh ƒë·ªông</th>
                  </tr>
                </thead>
                <tbody id="shiftsTableBody" class="bg-white divide-y divide-slate-200">
                  <tr><td colspan="7" class="text-center p-4 text-slate-500">ƒêang t·∫£i...</td></tr>
                </tbody>
              </table>
              </div>
            </div>
          </div>

          <!-- G√°n ca cho nh√¢n vi√™n -->
          <div class="card p-4 sm:p-5 bg-slate-50 border border-slate-200">
            <h3 class="text-base sm:text-lg font-semibold text-slate-700 mb-4">
              <i class="fas fa-user-plus mr-2 text-indigo-600"></i>G√°n Ca Cho Nh√¢n Vi√™n
            </h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
              <div>
                <label for="assignShiftEmployee" class="block text-slate-600 text-sm font-medium mb-2">
                  Ch·ªçn nh√¢n vi√™n <span class="text-red-500">*</span>
                </label>
                <select id="assignShiftEmployee" class="select-field">
                  <option value="">-- Ch·ªçn nh√¢n vi√™n --</option>
                </select>
              </div>
              <div>
                <label for="assignShiftName" class="block text-slate-600 text-sm font-medium mb-2">
                  Ch·ªçn ca <span class="text-red-500">*</span>
                </label>
                <select id="assignShiftName" class="select-field">
                  <option value="">-- Ch·ªçn ca --</option>
                </select>
              </div>
              <div class="flex items-end sm:col-span-2 lg:col-span-1">
                <button id="assignShiftBtn" class="btn-primary w-full">
                  <i class="fas fa-check mr-2"></i>G√°n Ca
                </button>
              </div>
            </div>
            <div id="assignShiftMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
          </div>
        </div>
      </div>

      <!-- B·∫£ng Ch·∫•m C√¥ng (Admin & Manager) -->
      <div id="attendanceReportView">
        <div class="card p-6">
          <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center">
            <i class="fas fa-file-invoice mr-3 text-indigo-600"></i>B·∫£ng Ch·∫•m C√¥ng
          </h2>
          
          <!-- B·ªô l·ªçc -->
          <div class="card p-5 mb-6 bg-slate-50 border border-slate-200">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <div>
                <label for="attendanceReportMonth" class="block text-slate-600 text-sm font-medium mb-2">
                  <i class="fas fa-calendar mr-1"></i>Th√°ng/NƒÉm
                </label>
                <input type="month" id="attendanceReportMonth" class="input-field" />
              </div>
              <div>
                <label for="attendanceReportEmployee" class="block text-slate-600 text-sm font-medium mb-2">
                  <i class="fas fa-user mr-1"></i>Nh√¢n vi√™n
                </label>
                <select id="attendanceReportEmployee" class="select-field">
                  <option value="">T·∫•t c·∫£ nh√¢n vi√™n</option>
                </select>
              </div>
              <div class="flex items-end">
                <button id="generateAttendanceReportBtn" class="btn-primary w-full">
                  <i class="fas fa-search mr-2"></i>T·∫°o B√°o C√°o
                </button>
              </div>
            </div>
          </div>

          <!-- K·∫øt qu·∫£ b√°o c√°o -->
          <div id="attendanceReportResults" class="hidden">
            <!-- T·ªïng quan -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
              <div class="card p-4 bg-blue-50 border border-blue-200">
                <p class="text-sm text-blue-600 font-medium">T·ªïng s·ªë gi·ªù</p>
                <p id="reportTotalHours" class="text-2xl font-bold text-blue-700">0</p>
              </div>
              <div class="card p-4 bg-green-50 border border-green-200">
                <p class="text-sm text-green-600 font-medium">S·ªë ng√†y l√†m vi·ªác</p>
                <p id="reportWorkingDays" class="text-2xl font-bold text-green-700">0</p>
              </div>
              <div class="card p-4 bg-yellow-50 border border-yellow-200">
                <p class="text-sm text-yellow-600 font-medium">S·ªë ng√†y ngh·ªâ</p>
                <p id="reportAbsentDays" class="text-2xl font-bold text-yellow-700">0</p>
              </div>
              <div class="card p-4 bg-purple-50 border border-purple-200">
                <p class="text-sm text-purple-600 font-medium">S·ªë l·∫ßn check-in</p>
                <p id="reportCheckIns" class="text-2xl font-bold text-purple-700">0</p>
              </div>
            </div>

            <!-- B·∫£ng chi ti·∫øt -->
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-slate-200 responsive-table">
                <thead class="bg-slate-50">
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">Ng√†y</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">Nh√¢n vi√™n</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">Ca</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">Check-in</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">Check-out</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">S·ªë gi·ªù</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">Tr·∫°ng th√°i</th>
                  </tr>
                </thead>
                <tbody id="attendanceReportTableBody" class="bg-white divide-y divide-slate-200">
                </tbody>
              </table>
            </div>

            <!-- N√∫t xu·∫•t Excel -->
            <div class="mt-4 flex justify-end">
              <button id="exportAttendanceReportBtn" class="btn-primary">
                <i class="fas fa-file-excel mr-2"></i>Xu·∫•t Excel
              </button>
            </div>
          </div>

          <div id="attendanceReportMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
        </div>
      </div>

      <div id="activityLogView">
        <div class="card p-6">
          <!-- Main Tabs -->
          <div class="mb-6 border-b border-slate-200 hidden">
            <div class="flex gap-4">
              <button class="main-tab active" data-main-tab="activity">
                <i class="fas fa-clipboard-list mr-2"></i>Nh·∫≠t K√Ω Ho·∫°t ƒê·ªông
              </button>
              <button class="main-tab" data-main-tab="changes">
                <i class="fas fa-history mr-2"></i>Thay ƒê·ªïi Nh·∫≠t K√Ω
              </button>
            </div>
          </div>

          <!-- Activity Log Content -->
          <div id="activityLogContent" class="main-tab-content">
            <h2 class="text-2xl font-bold text-slate-800 mb-6">
              Nh·∫≠t K√Ω Ho·∫°t ƒê·ªông
            </h2>
            
            <!-- Filter Section -->
            <div id="activityLogFilterSection" class="mb-6 bg-white rounded-lg border border-slate-200">
              <div class="flex items-center justify-between p-4 border-b border-slate-200 cursor-pointer hover:bg-slate-50 transition-colors" id="activityLogFilterHeader">
                <h3 class="text-base font-semibold text-slate-700 flex items-center">
                  <i class="fas fa-sliders-h mr-2 text-indigo-600"></i>B·ªô L·ªçc
                </h3>
                <button type="button" id="activityLogFilterToggle" class="text-slate-500 hover:text-slate-700 transition-colors">
                  <i class="fas fa-chevron-up" id="activityLogFilterToggleIcon"></i>
                </button>
              </div>
              <div id="activityLogFilterContent" class="p-5">
              <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-4">
                <div>
                  <label for="activityLogFilterActor" class="block text-slate-600 text-sm font-medium mb-1.5">T√™n truy c·∫≠p</label>
                  <input type="text" id="activityLogFilterActor" class="input-field" placeholder="Nh·∫≠p t√™n truy c·∫≠p" />
                </div>
                <div>
                  <label for="activityLogFilterTimeMin" class="block text-slate-600 text-sm font-medium mb-1.5">Kho·∫£ng th·ªùi gian</label>
                  <div class="flex gap-2">
                    <div class="flex-1 relative">
                      <input type="number" id="activityLogFilterTimeMin" class="input-field pr-8" placeholder="Min" min="0" />
                      <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex flex-col">
                        <button type="button" class="activity-time-btn text-xs text-slate-400 hover:text-slate-600" data-field="timeMin" data-dir="up">
                          <i class="fas fa-chevron-up"></i>
                        </button>
                        <button type="button" class="activity-time-btn text-xs text-slate-400 hover:text-slate-600" data-field="timeMin" data-dir="down">
                          <i class="fas fa-chevron-down"></i>
                        </button>
                      </div>
                    </div>
                    <div class="flex-1 relative">
                      <input type="number" id="activityLogFilterTimeMax" class="input-field pr-8" placeholder="Max" min="0" />
                      <div class="absolute right-2 top-1/2 transform -translate-y-1/2 flex flex-col">
                        <button type="button" class="activity-time-btn text-xs text-slate-400 hover:text-slate-600" data-field="timeMax" data-dir="up">
                          <i class="fas fa-chevron-up"></i>
                        </button>
                        <button type="button" class="activity-time-btn text-xs text-slate-400 hover:text-slate-600" data-field="timeMax" data-dir="down">
                          <i class="fas fa-chevron-down"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
                <div>
                  <label for="activityLogFilterService" class="block text-slate-600 text-sm font-medium mb-1.5">D·ªãch v·ª•</label>
                  <select id="activityLogFilterService" class="select-field">
                    <option value="">T·∫•t c·∫£</option>
                    <option value="success">Th√†nh c√¥ng</option>
                    <option value="error">L·ªói</option>
                  </select>
                </div>
                <div>
                  <label for="activityLogFilterAction" class="block text-slate-600 text-sm font-medium mb-1.5">Ho·∫°t ƒë·ªông</label>
                  <input type="text" id="activityLogFilterAction" class="input-field" placeholder="Nh·∫≠p ho·∫°t ƒë·ªông" />
                </div>
                <div class="sm:col-span-2 lg:col-span-2">
                  <label class="block text-slate-600 text-sm font-medium mb-1.5">Ph·∫°m vi ng√†y</label>
                  <div class="flex flex-wrap items-center gap-2">
                    <div class="flex items-center gap-1.5 flex-1 min-w-[140px]">
                      <input type="date" id="activityLogFilterDateFrom" class="input-field flex-1 min-w-0" />
                      <span class="text-slate-400 text-sm shrink-0">‚Üí</span>
                      <input type="date" id="activityLogFilterDateTo" class="input-field flex-1 min-w-0" />
                    </div>
                    <div class="flex flex-wrap gap-1.5 shrink-0">
                      <button type="button" id="activityLogFilterDate7Days" class="px-2.5 py-1.5 text-xs font-medium rounded-lg bg-slate-100 text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors">7 ng√†y qua</button>
                      <button type="button" id="activityLogFilterDateThisMonth" class="px-2.5 py-1.5 text-xs font-medium rounded-lg bg-slate-100 text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors">Th√°ng n√†y</button>
                      <button type="button" id="activityLogFilterDateLastMonth" class="px-2.5 py-1.5 text-xs font-medium rounded-lg bg-slate-100 text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 transition-colors">Th√°ng tr∆∞·ªõc</button>
                    </div>
                  </div>
                </div>
                <div>
                  <label for="activityLogFilterBrowser" class="block text-slate-600 text-sm font-medium mb-1.5">Tr√¨nh duy·ªát</label>
                  <input type="text" id="activityLogFilterBrowser" class="input-field" placeholder="T√¨m ki·∫øm..." />
                </div>
              </div>
              <div class="flex flex-wrap justify-end items-center gap-2 pt-4 border-t border-slate-200">
                <button id="clearActivityLogFiltersBtn" class="btn-secondary text-sm">
                  <i class="fas fa-redo mr-1.5"></i>X√≥a b·ªô l·ªçc
                </button>
                <button id="applyActivityLogFiltersBtn" class="btn-primary text-sm">
                  <i class="fas fa-search mr-1.5"></i>T√¨m
                </button>
              </div>
              </div>
            </div>

            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-slate-200 responsive-table">
                <thead class="bg-slate-50">
                  <tr>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase cursor-pointer hover:bg-slate-100">
                      <div class="flex items-center gap-1">
                        T√™n truy c·∫≠p
                        <i class="fas fa-sort text-slate-400"></i>
                      </div>
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      D·ªãch v·ª•
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Ho·∫°t ƒë·ªông
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Kho·∫£ng th·ªùi gian
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      ƒê·ªãa ch·ªâ IP
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Thi·∫øt b·ªã
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      N·ªÅn t·∫£ng
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Tr√¨nh duy·ªát
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-500 uppercase">
                      Th·ªùi gian
                    </th>
                    <th class="px-4 py-3 text-right text-xs font-semibold text-slate-500 uppercase">
                      H√†nh ƒë·ªông
                    </th>
                  </tr>
                </thead>
                <tbody id="activityLogTableBody" class="bg-white divide-y divide-slate-200"></tbody>
              </table>
            </div>
            
            <div class="flex justify-between items-center mt-4 pt-4 border-t border-slate-200">
              <div class="flex items-center gap-2">
                <button id="exportActivityLogBtn" class="btn-primary text-sm">
                  <i class="fas fa-file-excel mr-2"></i>Xu·∫•t sang excel
                </button>
              </div>
              <div id="activityLogPagination" class="flex items-center gap-2">
                <button id="activityLogFirstPageBtn" class="btn-secondary text-xs px-2 py-1">
                  <i class="fas fa-angle-double-left"></i>
                </button>
                <button id="activityLogPrevPageBtn" class="btn-secondary text-xs px-2 py-1">
                  <i class="fas fa-angle-left"></i>
                </button>
                <span class="text-sm text-slate-600 px-3">
                  Trang <span id="activityLogCurrentPage">1</span> / <span id="activityLogTotalPages">1</span>
                </span>
                <button id="activityLogNextPageBtn" class="btn-secondary text-xs px-2 py-1">
                  <i class="fas fa-angle-right"></i>
                </button>
                <button id="activityLogLastPageBtn" class="btn-secondary text-xs px-2 py-1">
                  <i class="fas fa-angle-double-right"></i>
                </button>
                <button id="activityLogRefreshBtn" class="btn-secondary text-xs px-2 py-1">
                  <i class="fas fa-sync-alt"></i>
                </button>
                <span class="text-sm text-slate-600 ml-2">
                  Hi·ªÉn th·ªã <span id="activityLogDisplayRange">0-0</span>/<span id="activityLogTotalCount">0</span>
                </span>
              </div>
            </div>
          </div>

          <!-- Changes Log Content -->
          <div id="changesLogContent" class="main-tab-content hidden">
            <div class="text-center p-8 text-slate-500">
              <i class="fas fa-history text-4xl mb-4 text-slate-300"></i>
              <p class="text-lg font-medium">Thay ƒê·ªïi Nh·∫≠t K√Ω</p>
              <p class="text-sm mt-2">T√≠nh nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="editAccountModal" class="modal">
      <div class="modal-content w-[95%] !max-w-lg md:!max-w-3xl">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-slate-800">
            Ch·ªânh S·ª≠a T√†i Kho·∫£n
          </h3>
          <span id="closeEditAccountModalBtn" class="cursor-pointer text-2xl">&times;</span>
        </div>
        <div class="space-y-4">
          <input type="hidden" id="editAccountUid" />
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="font-medium">Email:</label><input type="email" id="editAccountEmail"
                class="input-field bg-slate-100" disabled />
            </div>
            <div>
              <label class="font-medium">Vai tr√≤:</label><select id="editAccountRole" class="select-field"></select>
            </div>
            <div>
              <label class="font-medium">M√£ nh√¢n vi√™n (MSNV):</label><input type="text" id="editAccountEmployeeId"
                class="input-field" />
            </div>
            <div>
              <label class="font-medium">T√™n ng∆∞·ªùi d√πng:</label><input type="text" id="editAccountUsername"
                class="input-field" />
            </div>
            <div id="editAccountBranchContainer" class="md:col-span-2 hidden">
              <label class="font-medium">Chi nh√°nh <span class="text-red-500">*</span>:</label>
              <select id="editAccountBranch" class="select-field">
                <option value="">-- Ch·ªçn chi nh√°nh --</option>
              </select>
            </div>
          </div>
          <div id="managedBranchesContainer" class="hidden pt-4 border-t">
            <h4 class="font-semibold mb-2">Ph√¢n Quy·ªÅn Qu·∫£n L√Ω Chi Nh√°nh</h4>
            <div id="managedBranchesCheckboxes" class="grid grid-cols-2 md:grid-cols-3 gap-2 max-h-48 overflow-y-auto">
            </div>
          </div>
          <div id="allowedViewsContainer" class="pt-4 border-t">
            <h4 class="font-semibold mb-2">Ph√¢n Quy·ªÅn Truy C·∫≠p Ch·ª©c NƒÉng</h4>
            <div id="allowedViewsCheckboxes" class="grid grid-cols-2 md:grid-cols-3 gap-2"></div>
          </div>
          <div id="editAccountMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
          <div class="flex justify-end space-x-4 mt-6">
            <button id="cancelEditAccountBtn" class="btn-secondary">
              H·ªßy</button><button id="saveAccountDetailsBtn" class="btn-primary">
              <i class="fas fa-save mr-2"></i>L∆∞u Thay ƒê·ªïi
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="issueDetailModal" class="modal">
      <div class="modal-content w-[95%] !max-w-lg md:!max-w-4xl">
        <div class="mb-6">
          <!-- Header for mobile -->
          <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3 mb-4 sm:mb-4 relative">
            <h3 class="text-xl sm:text-2xl font-bold text-slate-800 flex-1 pr-10 sm:pr-0">Chi Ti·∫øt S·ª± C·ªë</h3>
            <span id="closeIssueDetailModalBtn" class="cursor-pointer text-2xl absolute top-0 right-0 sm:relative sm:top-0 sm:right-0 hover:text-slate-600 transition-colors flex items-center justify-center w-8 h-8 sm:w-auto sm:h-auto" aria-label="ƒê√≥ng">&times;</span>
          </div>
          <!-- Location display -->
          <div class="flex items-start gap-2 bg-indigo-50 border border-indigo-200 rounded-lg p-3 sm:p-4 mt-4">
            <div class="flex-1 min-w-0">
              <p id="detailIssueLocation" class="text-sm sm:text-base font-semibold text-indigo-600 break-words" title=""></p>
            </div>
          </div>
        </div>
        <input type="hidden" id="detailIssueId" />
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div class="lg:col-span-2 space-y-4">
            <div>
              <h4 class="font-semibold text-slate-700">M√¥ t·∫£</h4>
              <p id="detailIssueDescription" class="p-3 bg-slate-50 rounded-md mt-1 min-h-[6rem]"></p>
            </div>
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <div>
                <h4 class="font-semibold text-slate-700">H√¨nh ·∫£nh ban ƒë·∫ßu</h4>
                <div id="detailIssueImageContainer" class="mt-2"></div>
              </div>
              <div>
                <h4 class="font-semibold text-slate-700">
                  H√¨nh ·∫£nh ƒë√£ s·ª≠a ch·ªØa
                </h4>
                <div id="detailRepairedImageContainer" class="mt-2"></div>
              </div>
            </div>
            <div class="pt-4 border-t">
              <h4 class="font-semibold text-slate-700 mb-2">Th·∫£o lu·∫≠n</h4>
              <div id="detailIssueComments"
                class="space-y-3 max-h-60 overflow-y-auto pr-2 mb-4 bg-slate-50 p-2 rounded-md"></div>
              <div class="flex flex-col sm:flex-row gap-2 relative">
                <div class="flex-grow relative">
                  <input type="text" id="newCommentInput" class="input-field w-full pr-10" placeholder="Th√™m b√¨nh lu·∫≠n... (G√µ @ ƒë·ªÉ tag ng∆∞·ªùi d√πng)" />
                  <div id="mentionSuggestions" class="hidden absolute top-full left-0 right-0 mt-1 bg-white border border-slate-200 rounded-lg shadow-lg max-h-48 overflow-y-auto z-50"></div>
                </div>
                <button id="addCommentBtn" class="btn-primary w-full sm:w-auto whitespace-nowrap">G·ª≠i</button>
              </div>
            </div>
          </div>
          <div class="space-y-4 p-4 bg-slate-50 rounded-lg">
            <h4 class="font-bold text-lg text-slate-800 border-b pb-2">
              Th√¥ng Tin
            </h4>
            <div>
              <strong>Ng∆∞·ªùi b√°o c√°o:</strong>
              <span id="detailReporterName"></span>
            </div>
            <div><div class="pt-4 border-t"></div>
              <strong>Ng√†y b√°o c√°o:</strong>
              <span id="detailReportDate"></span>
            </div>
            <div>
              <strong>∆Øu ti√™n:</strong> <span id="detailIssuePriority"></span>
            </div>
            <div id="resolutionInfoContainer" class="hidden pt-3 border-t border-dashed border-slate-300">
              <div class="font-semibold text-green-600 mb-2">
                <i class="fas fa-check-circle mr-2"></i>ƒê√É GI·∫¢I QUY·∫æT
              </div>
              <div>
                <strong>Ng∆∞·ªùi gi·∫£i quy·∫øt:</strong>
                <span id="detailResolverName" class="font-medium"></span>
              </div>
              <div>
                <strong>Ng√†y gi·∫£i quy·∫øt:</strong>
                <span id="detailResolvedDate" class="font-medium"></span>
              </div>
            </div>
            <div class="pt-4 border-t">
              <h4 class="font-bold text-lg text-slate-800 border-b pb-2 mb-2">
                H√†nh ƒê·ªông
              </h4>
              <div>
                <label class="font-medium">Tr·∫°ng th√°i:</label><select id="detailIssueStatus"
                  class="select-field"></select>
              </div>
              <div>
                <label class="font-medium">Giao cho:</label>
                <div class="relative">
                  <div id="assigneeMultiSelect" class="min-h-[42px] border border-slate-300 rounded-md bg-white p-2 flex flex-wrap gap-2 items-center cursor-pointer hover:border-indigo-500 focus-within:border-indigo-500 focus-within:ring-2 focus-within:ring-indigo-200">
                    <div id="assigneeSelectedTags" class="flex flex-wrap gap-2 flex-1"></div>
                    <input type="text" id="assigneeSearchInput" class="flex-1 min-w-[120px] border-0 outline-none text-sm" placeholder="Ch·ªçn ng∆∞·ªùi..." autocomplete="off" />
                    <i class="fas fa-chevron-down text-slate-400"></i>
                  </div>
                  <div id="assigneeDropdown" class="hidden absolute z-[9999] w-full mt-1 bg-white border border-slate-200 rounded-lg shadow-lg max-h-60 overflow-y-auto" style="position: absolute; z-index: 9999;">
                    <div id="assigneeOptions" class="p-2"></div>
                  </div>
                  <input type="hidden" id="detailIssueAssignee" />
                </div>
                <p class="text-xs text-slate-500 mt-1">C√≥ th·ªÉ ch·ªçn m·ªôt ho·∫∑c nhi·ªÅu ng∆∞·ªùi</p>
              </div>
              <div id="repairedImageUploadContainer" class="hidden mt-4">
                <label for="repairedImageInput" class="font-medium text-sm">·∫¢nh s·ª≠a ch·ªØa (b·∫Øt bu·ªôc):</label>
                <input type="file" id="repairedImageInput" class="input-field mt-1" accept="image/*" />
              </div>
              <button id="updateIssueBtn" class="btn-primary w-full mt-4">
                C·∫≠p nh·∫≠t
              </button>
              <div id="detailIssueMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- My Profile Modal -->
    <div id="myProfileModal" class="modal">
      <div class="modal-content w-[95%] !max-w-2xl">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-slate-800 flex items-center">
            <i class="fas fa-user mr-3 text-indigo-600"></i>H·ªì s∆° c·ªßa t√¥i
          </h3>
          <span id="closeMyProfileModalBtn" class="cursor-pointer text-2xl">&times;</span>
        </div>
        
        <div class="space-y-6">
          <!-- Th√¥ng tin c√° nh√¢n -->
          <div class="border-b border-slate-200 pb-6">
            <h3 class="text-xl font-semibold text-slate-800 mb-4">
              Th√¥ng tin c√° nh√¢n
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="profileEmail" class="block text-slate-600 text-sm font-medium mb-2">
                  Email:
                </label>
                <input type="email" id="profileEmail" class="input-field" />
                <p class="text-xs text-slate-500 mt-1">C√≥ th·ªÉ thay ƒë·ªïi email c·ªßa b·∫°n t·∫°i ƒë√¢y</p>
              </div>
              <div>
                <label for="profileEmployeeId" class="block text-slate-600 text-sm font-medium mb-2">
                  M√£ nh√¢n vi√™n (MSNV):
                </label>
                <input type="text" id="profileEmployeeId" class="input-field bg-slate-100" disabled />
              </div>
              <div>
                <label for="profileRole" class="block text-slate-600 text-sm font-medium mb-2">
                  Vai tr√≤:
                </label>
                <input type="text" id="profileRole" class="input-field bg-slate-100" disabled />
              </div>
              <div>
                <label for="profileDisplayName" class="block text-slate-600 text-sm font-medium mb-2">
                  T√™n hi·ªÉn th·ªã:
                </label>
                <input type="text" id="profileDisplayName" class="input-field" />
              </div>
            </div>
            <button id="updateProfileBtn" class="btn-primary mt-4">
              <i class="fas fa-save mr-2"></i>C·∫≠p nh·∫≠t th√¥ng tin
            </button>
            <div id="profileUpdateMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
          </div>

          <!-- ƒê·ªïi m·∫≠t kh·∫©u -->
          <div>
            <h3 class="text-xl font-semibold text-slate-800 mb-4">
              ƒê·ªïi m·∫≠t kh·∫©u
            </h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div>
                <label for="profileCurrentPassword" class="block text-slate-600 text-sm font-medium mb-2">
                  M·∫≠t kh·∫©u hi·ªán t·∫°i:
                </label>
                <input type="password" id="profileCurrentPassword" class="input-field" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
              </div>
              <div>
                <label for="profileNewPassword" class="block text-slate-600 text-sm font-medium mb-2">
                  M·∫≠t kh·∫©u m·ªõi (t·ªëi thi·ªÉu 6 k√Ω t·ª±):
                </label>
                <input type="password" id="profileNewPassword" class="input-field" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
              </div>
              <div>
                <label for="profileConfirmPassword" class="block text-slate-600 text-sm font-medium mb-2">
                  X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi:
                </label>
                <input type="password" id="profileConfirmPassword" class="input-field" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
              </div>
            </div>
            <button id="changePasswordBtn" class="btn-primary mt-4">
              <i class="fas fa-key mr-2"></i>ƒê·ªïi m·∫≠t kh·∫©u
            </button>
            <div id="passwordChangeMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal for Cancel/Delete Actions -->
    <div id="confirmCancelModal" class="modal">
      <div class="modal-content !max-w-lg">
        <div class="flex justify-between items-start mb-4">
          <h3 class="text-xl font-bold text-slate-800">
            <i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>X√°c nh·∫≠n H·ªßy
          </h3>
          <span id="closeConfirmCancelModalBtn" class="cursor-pointer text-2xl">&times;</span>
        </div>
        <div class="mb-6">
          <p class="text-slate-700 mb-4" id="confirmCancelMessage">
            B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën h·ªßy s·ª± c·ªë n√†y kh√¥ng?
          </p>
          <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
            <p class="text-sm text-yellow-800">
              <i class="fas fa-info-circle mr-2"></i>
              <strong>L∆∞u √Ω:</strong> H√†nh ƒë·ªông n√†y s·∫Ω ƒë√°nh d·∫•u s·ª± c·ªë l√† "ƒê√£ h·ªßy" v√† kh√¥ng th·ªÉ ho√†n t√°c.
            </p>
          </div>
        </div>
        <div class="flex justify-end space-x-3">
          <button id="cancelConfirmCancelBtn" class="btn-secondary">
            <i class="fas fa-times mr-2"></i>Kh√¥ng
          </button>
          <button id="confirmCancelBtn" class="btn-danger">
            <i class="fas fa-check mr-2"></i>C√≥, h·ªßy s·ª± c·ªë
          </button>
        </div>
      </div>
    </div>

    <div id="deleteAccountModal" class="modal">
      <div class="modal-content !max-w-lg">
        <div class="flex justify-between items-start mb-4">
          <h3 class="text-xl font-bold text-slate-800">
            V√¥ hi·ªáu h√≥a T√†i kho·∫£n
          </h3>
          <span id="closeDeleteModalBtn" class="cursor-pointer text-2xl">&times;</span>
        </div>
        <p class="text-slate-600 mb-6">
          T√†i kho·∫£n <strong id="deleteAccountName"></strong> s·∫Ω kh√¥ng th·ªÉ ƒëƒÉng
          nh·∫≠p. D·ªØ li·ªáu c·ªßa h·ªç s·∫Ω ƒë∆∞·ª£c x·ª≠ l√Ω theo l·ª±a ch·ªçn b√™n d∆∞·ªõi.
        </p>
        <input type="hidden" id="deleteAccountUid" />

        <div class="space-y-4">
          <div class="p-4 border rounded-lg">
            <h4 class="font-semibold text-slate-800">
              1. V√¥ hi·ªáu h√≥a T√†i kho·∫£n
            </h4>
            <p class="text-sm text-slate-500 mt-1 mb-3">
              Ch·ªâ v√¥ hi·ªáu h√≥a t√†i kho·∫£n. D·ªØ li·ªáu h·ªç t·∫°o ra (nh∆∞ b√°o c√°o s·ª± c·ªë)
              s·∫Ω ƒë∆∞·ª£c gi·ªØ nguy√™n.
            </p>
            <button id="confirmDisableProfileOnlyBtn" class="btn-secondary w-full">
              Th·ª±c hi·ªán V√¥ hi·ªáu h√≥a
            </button>
          </div>
          <div class="p-4 border border-red-300 rounded-lg bg-red-50">
            <h4 class="font-semibold text-red-800">
              2. V√¥ hi·ªáu h√≥a v√† ·∫®n danh D·ªØ li·ªáu
            </h4>
            <p class="text-sm text-red-600 mt-1 mb-3">
              V√¥ hi·ªáu h√≥a t√†i kho·∫£n v√† ·∫©n danh t·∫•t c·∫£ b√°o c√°o s·ª± c·ªë do ng∆∞·ªùi
              n√†y t·∫°o. D·ªØ li·ªáu ch·∫•m c√¥ng v·∫´n ƒë∆∞·ª£c gi·ªØ l·∫°i.
            </p>
            <button id="confirmDisableAndAnonymizeBtn" class="btn-danger w-full">
              Th·ª±c hi·ªán V√¥ hi·ªáu h√≥a & ·∫®n danh
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="cameraModal" class="modal">
      <div class="modal-content w-[95%] max-w-xl h-2/3 flex flex-col">
        <div class="flex justify-between items-center mb-4 flex-shrink-0">
          <h3 id="cameraModalTitle" class="text-xl font-bold text-slate-800">
            ƒêi·ªÉm Danh
          </h3>
          <span id="closeCameraModalBtn" class="cursor-pointer text-2xl">&times;</span>
        </div>
        <div class="relative w-full bg-slate-800 rounded-lg overflow-hidden flex-grow">
          <video id="cameraFeed" class="w-full h-full object-cover" autoplay playsinline></video>
          <canvas id="photoCanvas" class="hidden"></canvas>
          <img id="photoPreview" src="" class="hidden absolute top-0 left-0 w-full h-full object-cover" />
          <div id="camera-overlay"
            class="absolute bottom-0 left-0 w-full p-4 bg-gradient-to-t from-black/60 to-transparent text-white">
            <div class="flex items-end">
              <p id="camera-time" class="text-5xl font-bold leading-none">
                00:00
              </p>
              <div class="ml-4 text-sm">
                <p id="camera-date">Ng√†y 1, Th√°ng 1, 2000</p>
                <p id="camera-day">Th·ª© Hai</p>
              </div>
            </div>
            <p id="camera-address" class="text-xs mt-2 truncate">
              ƒêang l·∫•y v·ªã tr√≠...
            </p>
            <p id="camera-user" class="text-sm font-semibold mt-1">H·ªç t√™n:</p>
          </div>
        </div>
        <div id="cameraMessage" class="hidden mt-4 p-3 rounded-lg text-sm flex-shrink-0"></div>
        <div class="flex justify-center space-x-4 mt-4 flex-shrink-0">
          <button id="captureBtn" class="btn-primary px-8 py-3 rounded-full">
            <i class="fas fa-camera"></i>
          </button>
          <button id="recaptureBtn" class="btn-secondary hidden">
            Ch·ª•p L·∫°i
          </button>
          <button id="confirmAttendanceBtn" class="btn-primary hidden">
            X√°c Nh·∫≠n
          </button>
        </div>
      </div>
    </div>

    <!-- Language Selection Modal -->
    <div id="languageModal" class="modal">
      <div class="modal-content !max-w-md">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-slate-800 flex items-center">
            <i class="fas fa-language mr-3 text-indigo-600"></i>Thay ƒë·ªïi ng√¥n ng·ªØ
          </h3>
          <span id="closeLanguageModalBtn" class="cursor-pointer text-2xl">&times;</span>
        </div>
        <div class="space-y-4">
          <p class="text-slate-600 mb-4">Ch·ªçn ng√¥n ng·ªØ cho giao di·ªán:</p>
          <div class="space-y-2">
            <button id="selectVietnameseBtn" class="w-full flex items-center justify-between p-4 border-2 border-slate-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all">
              <div class="flex items-center">
                <i class="fas fa-check-circle text-indigo-600 mr-3 language-selected-icon hidden"></i>
                <i class="far fa-circle text-slate-400 mr-3 language-unselected-icon"></i>
                <div class="text-left">
                  <div class="font-semibold text-slate-800">Ti·∫øng Vi·ªát</div>
                  <div class="text-sm text-slate-500">Vietnamese</div>
                </div>
              </div>
              <span class="text-2xl">üáªüá≥</span>
            </button>
            <button id="selectEnglishBtn" class="w-full flex items-center justify-between p-4 border-2 border-slate-200 rounded-lg hover:border-indigo-500 hover:bg-indigo-50 transition-all">
              <div class="flex items-center">
                <i class="fas fa-check-circle text-indigo-600 mr-3 language-selected-icon hidden"></i>
                <i class="far fa-circle text-slate-400 mr-3 language-unselected-icon"></i>
                <div class="text-left">
                  <div class="font-semibold text-slate-800">English</div>
                  <div class="text-sm text-slate-500">Ti·∫øng Anh</div>
                </div>
              </div>
              <span class="text-2xl">üá∫üá∏</span>
            </button>
          </div>
          <div id="languageMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
        </div>
      </div>
    </div>

    <div id="resetPasswordModal" class="modal">
      <div class="modal-content !max-w-md">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold">ƒê·∫∑t L·∫°i M·∫≠t Kh·∫©u</h3>
          <span id="closeResetPasswordModalBtn" class="cursor-pointer text-2xl">&times;</span>
        </div>
        <p class="text-sm text-slate-600 mb-4">
          Vui l√≤ng nh·∫≠p email ho·∫∑c t√™n ƒëƒÉng nh·∫≠p c·ªßa b·∫°n. M·∫≠t kh·∫©u s·∫Ω ƒë∆∞·ª£c reset v·ªÅ m·∫∑c ƒë·ªãnh <strong>icool123</strong>. 
          Sau khi ƒëƒÉng nh·∫≠p, b·∫°n s·∫Ω ƒë∆∞·ª£c y√™u c·∫ßu ƒë·ªïi m·∫≠t kh·∫©u.
        </p>
        <div>
          <label for="resetEmail" class="block text-slate-700 text-sm font-medium mb-2">Email ho·∫∑c T√™n ƒëƒÉng nh·∫≠p:</label>
          <input type="text" id="resetEmail" class="input-field" placeholder="email@example.com ho·∫∑c t√™n ƒëƒÉng nh·∫≠p" />
        </div>
        <div id="resetPasswordMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
        <div class="flex justify-end space-x-4 mt-6">
          <button id="cancelResetBtn" class="btn-secondary">H·ªßy</button>
          <button id="sendResetEmailBtn" class="btn-primary">G·ª≠i</button>
        </div>
      </div>
    </div>

    <div id="forceChangePasswordModal" class="modal">
      <div class="modal-content !max-w-md">
        <h3 class="text-2xl font-bold text-slate-800 mb-4">
          Y√™u C·∫ßu Thay ƒê·ªïi M·∫≠t Kh·∫©u
        </h3>
        <p class="text-sm text-slate-600 mb-6">
          ƒê·ªÉ ƒë·∫£m b·∫£o an to√†n cho t√†i kho·∫£n, b·∫°n c·∫ßn ƒë·∫∑t m·ªôt m·∫≠t kh·∫©u m·ªõi. M·∫≠t
          kh·∫©u m·ªõi ph·∫£i c√≥ √≠t nh·∫•t 6 k√Ω t·ª±.
        </p>
        <div class="space-y-4">
          <div>
            <label for="forceCurrentPassword" class="block text-slate-700 text-sm font-medium mb-2">M·∫≠t kh·∫©u hi·ªán t·∫°i:</label>
            <input type="password" id="forceCurrentPassword" class="input-field" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
          </div>
          <div>
            <label for="newPassword" class="block text-slate-700 text-sm font-medium mb-2">M·∫≠t kh·∫©u m·ªõi:</label>
            <input type="password" id="newPassword" class="input-field" />
          </div>
          <div>
            <label for="confirmNewPassword" class="block text-slate-700 text-sm font-medium mb-2">X√°c nh·∫≠n m·∫≠t kh·∫©u
              m·ªõi:</label>
            <input type="password" id="confirmNewPassword" class="input-field" />
          </div>
        </div>
        <div id="changePasswordMessage" class="hidden mt-4 p-3 rounded-lg text-sm"></div>
        <div class="mt-6">
          <button id="confirmChangePasswordBtn" class="btn-primary w-full py-3">
            Thay ƒê·ªïi M·∫≠t Kh·∫©u
          </button>
        </div>
      </div>
    </div>

    <div id="drillDownModal" class="modal">
      <div class="modal-content w-[95%] !max-w-2xl lg:!max-w-5xl h-5/6 flex flex-col">
        <div class="flex justify-between items-center mb-4 flex-shrink-0">
          <h3 id="drillDownTitle" class="text-2xl font-bold text-slate-800">
            Chi ti·∫øt
          </h3>
          <span id="closeDrillDownModalBtn" class="cursor-pointer text-2xl">&times;</span>
        </div>
        <div id="drillDownContent" class="overflow-y-auto flex-grow"></div>
        <div class="flex justify-end mt-6 flex-shrink-0">
          <button id="cancelDrillDownBtn" class="btn-secondary">ƒê√≥ng</button>
        </div>
      </div>
    </div>
  </div>

  <footer class="bg-slate-50 border-t border-slate-200 py-6 mt-8">
    <div class="container mx-auto px-4">
      <div class="flex flex-col items-center justify-center space-y-4">
        <!-- Logo Section -->
        <div class="flex items-center justify-center gap-6 flex-wrap" id="footerLogos">
          <img 
            id="icoolLogo"
            src="assets/images/icool-logo.jpg" 
            alt="ICOOL Logo" 
            class="h-12 object-contain max-w-[150px]"
            onerror="this.onerror=null; this.src='./assets/images/icool-logo.jpg'; console.warn('ƒêang th·ª≠ ƒë∆∞·ªùng d·∫´n d·ª± ph√≤ng cho logo ICOOL');"
          />
          <img 
            id="spaaLogo"
            src="assets/images/spaa-logo.png" 
            alt="SPAA Logo" 
            class="h-12 object-contain max-w-[150px]"
            onerror="this.onerror=null; this.src='./assets/images/spaa-logo.png'; console.warn('ƒêang th·ª≠ ƒë∆∞·ªùng d·∫´n d·ª± ph√≤ng cho logo SPAA');"
          />
        </div>
        <!-- Copyright Text -->
        <p class="text-sm text-slate-600">
          ¬© 2025 by Dev ICOOL - SPACE A&A
        </p>
      </div>
    </div>
  </footer>

  <script>
    // Ensure logos load correctly regardless of server setup
    (function() {
      const logoPaths = [
        '/assets/images/',
        'assets/images/',
        './assets/images/',
        '../assets/images/'
      ];
      
      const logos = [
        { id: 'icoolLogo', file: 'icool-logo.jpg' },
        { id: 'spaaLogo', file: 'spaa-logo.png' }
      ];
      
      logos.forEach(logo => {
        const img = document.getElementById(logo.id);
        if (!img) return;
        
        let currentPathIndex = 0;
        
        const tryNextPath = () => {
          if (currentPathIndex >= logoPaths.length) {
            console.error(`Kh√¥ng th·ªÉ t·∫£i ${logo.file} t·ª´ t·∫•t c·∫£ c√°c ƒë∆∞·ªùng d·∫´n`);
            return;
          }
          
          const testPath = logoPaths[currentPathIndex] + logo.file;
          const testImg = new Image();
          
          testImg.onload = () => {
            img.src = testPath;
            console.log(`‚úÖ ƒê√£ t·∫£i ${logo.file} t·ª´: ${testPath}`);
          };
          
          testImg.onerror = () => {
            currentPathIndex++;
            tryNextPath();
          };
          
          testImg.src = testPath;
        };
        
        // Start trying paths
        img.onerror = () => {
          img.onerror = null; // Prevent infinite loop
          tryNextPath();
        };
      });
    })();
  </script>
</body>

</html>